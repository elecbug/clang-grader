FROM ubuntu:22.04

# Install toolchain, locales, C standard library headers, and Python
RUN apt-get update && \
    apt-get install -y --no-install-recommends \
        build-essential python3 python3-pip ca-certificates time locales && \
    rm -rf /var/lib/apt/lists/* && \
    locale-gen en_US.UTF-8 ko_KR.UTF-8

# Set UTF-8 locale
ENV LANG=ko_KR.UTF-8 \
    LANGUAGE=ko_KR:en \
    LC_ALL=ko_KR.UTF-8

WORKDIR /app

COPY grade_runner.py /app/grade_runner.py
COPY grade_runner/ /app/grade_runner/

ENV CFLAGS="-O2 -std=c17 -Wall -Wextra" \
    BIN_OUT="/work/a.out"

ENTRYPOINT ["python3", "/app/grade_runner.py"]
